<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Editor Massivo de Parâmetros - Revit"
        Height="750" Width="1100"
        Background="#1E1E1E"
        Foreground="White"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResizeWithGrip">

    <Window.Resources>
        <!-- Cores e estilos consistentes -->
        <SolidColorBrush x:Key="BackgroundColor" Color="#1E1E1E"/>
        <SolidColorBrush x:Key="PanelColor" Color="#2D2D30"/>
        <SolidColorBrush x:Key="BorderColor" Color="#3E3E42"/>
        <SolidColorBrush x:Key="TextColor" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="AccentColor" Color="#007ACC"/>
        <SolidColorBrush x:Key="HoverColor" Color="#3E3E42"/>

        <!-- Estilo para TextBox -->
        <Style TargetType="TextBox">
            <Setter Property="Background" Value="#2D2D30"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#3E3E42"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="6"/>
            <Setter Property="FontSize" Value="12"/>
        </Style>

        <!-- Estilo para ComboBox -->
        <Style TargetType="ComboBox">
            <Setter Property="Background" Value="#2D2D30"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#3E3E42"/>
            <Setter Property="Padding" Value="6"/>
        </Style>
        
        <Style TargetType="ComboBoxItem">
            <Setter Property="Background" Value="#2D2D30"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>

        <!-- Estilo para DataGrid -->
        <Style TargetType="DataGrid">
            <Setter Property="Background" Value="#252526"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="RowBackground" Value="#1E1E1E"/>
            <Setter Property="AlternatingRowBackground" Value="#2D2D30"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#3E3E42"/>
            <Setter Property="VerticalGridLinesBrush" Value="#3E3E42"/>
            <Setter Property="BorderBrush" Value="#3E3E42"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="RowHeight" Value="24"/>
            <Setter Property="FontSize" Value="11"/>
        </Style>

        <Style TargetType="DataGridRow">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#3E3E42"/>
        </Style>

        <Style TargetType="DataGridCell">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#3E3E42"/>
            <Setter Property="Padding" Value="4"/>
        </Style>

        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#2D2D30"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#3E3E42"/>
            <Setter Property="Height" Value="28"/>
        </Style>

        <!-- Estilo para Botões -->
        <Style TargetType="Button" x:Key="BaseButtonStyle">
            <Setter Property="Background" Value="#2D2D30"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="BorderBrush" Value="#3E3E42"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Margin" Value="4,0"/>
        </Style>

        <Style TargetType="Button" BasedOn="{StaticResource BaseButtonStyle}">
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#3E3E42"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="Button" x:Key="AccentButtonStyle" BasedOn="{StaticResource BaseButtonStyle}">
            <Setter Property="Background" Value="#007ACC"/>
            <Setter Property="BorderBrush" Value="#007ACC"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>

        <!-- Estilo para Labels -->
        <Style TargetType="Label">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <!-- Estilo para CheckBox -->
        <Style TargetType="CheckBox">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <!-- Estilo para GroupBox -->
        <Style TargetType="GroupBox">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#3E3E42"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="Margin" Value="0,8"/>
        </Style>

    </Window.Resources>

    <Grid Margin="10" Background="{StaticResource BackgroundColor}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Cabeçalho -->
        <TextBlock Grid.Row="0" Text="EDITOR MASSIVO DE PARÂMETROS" 
                   FontSize="16" FontWeight="Bold" 
                   Foreground="White" HorizontalAlignment="Center"
                   Margin="0,0,0,12"/>

        <!-- Seção 1: Parâmetro e Seleção -->
        <GroupBox Grid.Row="1" Header="Parâmetro e Escopo">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Label Content="Parâmetro:" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <ComboBox x:Name="param_cb" Grid.Column="1" Height="28"/>
                <CheckBox x:Name="use_selection_cb" Grid.Column="2" 
                         Content="Usar apenas elementos selecionados" 
                         VerticalAlignment="Center" Margin="20,0,0,0"/>
            </Grid>
        </GroupBox>

        <!-- Seção 2: Regras de Substituição -->
        <GroupBox Grid.Row="2" Header="Regras de Substituição (Regex)">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Label Content="Procurar:" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <TextBox x:Name="old_format_tb" Grid.Column="1" Height="28"/>
                <Label Content="Substituir:" Grid.Column="2" VerticalAlignment="Center" Margin="20,0,8,0"/>
                <TextBox x:Name="new_format_tb" Grid.Column="3" Height="28"/>
            </Grid>
        </GroupBox>

        <!-- Seção 3: Regras Adicionais -->
        <GroupBox Grid.Row="3" Header="Regras Adicionais">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <Label Content="Prefixo:" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <TextBox x:Name="prefix_tb" Grid.Column="1" Height="28" Margin="0,0,8,0"/>
                
                <Label Content="Sufixo:" Grid.Column="2" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <TextBox x:Name="suffix_tb" Grid.Column="3" Height="28" Margin="0,0,8,0"/>
                
                <Label Content="Find:" Grid.Column="4" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <TextBox x:Name="find_tb" Grid.Column="5" Height="28" Margin="0,0,8,0"/>
                
                <CheckBox x:Name="numbering_cb" Grid.Column="6" 
                         Content="Numeração automática" 
                         VerticalAlignment="Center"/>
            </Grid>
        </GroupBox>

        <!-- Seção 4: Substituição Simples -->
        <GroupBox Grid.Row="4" Header="Substituição Simples (Texto Literal)">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Label Content="Procurar:" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <TextBox x:Name="find_simple_tb" Grid.Column="1" Height="28"/>
                <Label Content="Substituir:" Grid.Column="2" VerticalAlignment="Center" Margin="20,0,8,0"/>
                <TextBox x:Name="replace_simple_tb" Grid.Column="3" Height="28"/>
            </Grid>
        </GroupBox>

        <!-- Seção 5: Filtro e Controles -->
        <GroupBox Grid.Row="5" Header="Filtro e Seleção">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <Label Content="Filtrar:" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <TextBox x:Name="filter_tb" Grid.Column="1" Height="28" Margin="0,0,12,0"/>
                
                <Button x:Name="select_all_btn" Grid.Column="2" Content="Selecionar Tudo" 
                        Width="120" Margin="0,0,8,0" Style="{StaticResource BaseButtonStyle}"/>
                <Button x:Name="select_none_btn" Grid.Column="3" Content="Limpar Seleção" 
                        Width="120" Margin="0,0,8,0" Style="{StaticResource BaseButtonStyle}"/>
                <Button x:Name="update_btn" Grid.Column="4" Content="Atualizar Preview" 
                        Width="140" Style="{StaticResource BaseButtonStyle}"/>
            </Grid>
        </GroupBox>

        <!-- Seção 6: Preview -->
        <GroupBox Grid.Row="6" Header="Pré-visualização das Alterações">
            <DataGrid x:Name="preview_dg"
                      AutoGenerateColumns="False"
                      CanUserAddRows="False"
                      SelectionMode="Extended">
                <DataGrid.Columns>
                    <DataGridCheckBoxColumn Header="Sel." Binding="{Binding is_selected}" Width="40"/>
                    <DataGridTextColumn Header="ID" Binding="{Binding elem_id}" Width="70" IsReadOnly="True"/>
                    <DataGridTextColumn Header="Categoria" Binding="{Binding category}" Width="120" IsReadOnly="True"/>
                    <DataGridTextColumn Header="Elemento" Binding="{Binding elem_name}" Width="180" IsReadOnly="True"/>
                    <DataGridTextColumn Header="Valor Original" Binding="{Binding original}" Width="200" IsReadOnly="True"/>
                    <DataGridTextColumn Header="Novo Valor" Binding="{Binding new}" Width="200" IsReadOnly="True"/>
                </DataGrid.Columns>
            </DataGrid>
        </GroupBox>

        <!-- Seção 7: Botões de Ação -->
        <StackPanel Grid.Row="7" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,12,0,0">
            <Button x:Name="apply_btn" Content="Aplicar Alterações" 
                    Width="160" Style="{StaticResource AccentButtonStyle}"/>
            <Button x:Name="cancel_btn" Content="Fechar" 
                    Width="100" Style="{StaticResource BaseButtonStyle}"/>
        </StackPanel>

    </Grid>
</Window>